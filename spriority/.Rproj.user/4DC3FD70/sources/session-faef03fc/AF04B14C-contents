library(tidyverse)
library(viridis)
library(maps)

#Load environmental data

library(readxl)
data_grass <- read_excel("C:/Users/Delor003/OneDrive - Universiteit Utrecht/Documents/Research/Grant proposals/ERC/ERC consolidator grant/Data_GRASS/Ben_list.xlsx")

data_grass$latitude <- as.numeric(data_grass$latitude)
data_grass$longitude <- as.numeric(data_grass$longitude)

data_grass$restoration <- factor(data_grass$restoration,
                                 levels=c("reference", "mowing", "topsoil_removal", "topsoil_removal_greenhay"))

#Create map of BEGIN network

some.eu.countries <- c("Netherlands")

some.eu.maps <- map_data("world2", region = some.eu.countries)

ggplot(some.eu.maps, aes(x = long, y = lat, subgroup = group)) +
  geom_polygon(fill="lightgray", colour = "lightgray")+
  coord_map()+
  theme_minimal()+
  # scale_y_continuous(limits=c(41,62))+
  # scale_x_continuous(limits=c(-10.5,20))+
  geom_point(data=data_grass,
             aes(x=longitude,
                 y=latitude,
                 colour=restoration,
                 shape=grassland_type),
             inherit.aes = FALSE)+
  scale_colour_viridis(name="Restoration method",
                       option="D",
                       discrete = TRUE,
                       direction = -1)+
  scale_shape_manual(name="Grassland type",
                     values=c(16,17,15))+
  xlab("Longitude (°)")+
  ylab("Latitude (°)")+
  theme(axis.title.x = element_text(margin=margin(t=10)),
        axis.title.y = element_text(margin=margin(r=10)))

ggsave("C:/Users/Delor003/OneDrive - Universiteit Utrecht/Documents/Research/Grant proposals/ERC/ERC consolidator grant/Data_GRASS/GRASS_map.png",
       dpi=1000)

ggplot(some.eu.maps, aes(x = long, y = lat, subgroup = group)) +
  geom_polygon(fill="lightgray", colour = "lightgray")+
  coord_map()+
  theme_minimal()+
  # scale_y_continuous(limits=c(41,62))+
  # scale_x_continuous(limits=c(-10.5,20))+
  geom_point(data=data_grass,
             aes(x=longitude,
                 y=latitude,
                 colour=restoration,
                 shape=grassland_type),
             inherit.aes = FALSE,
             size=3)+
  scale_colour_viridis(name="Restoration method",
                       option="D",
                       discrete = TRUE,
                       direction = -1)+
  scale_shape_manual(name="Grassland type",
                     values=c(16,17,15))+
  xlab("")+
  ylab("")+
  theme(axis.title.x = element_text(margin=margin(t=10)),
        axis.title.y = element_text(margin=margin(r=10)),
        panel.grid = element_blank(),
        axis.title = element_blank(),
        axis.text = element_blank())

ggsave("C:/Users/Delor003/OneDrive - Universiteit Utrecht/Documents/Research/Grant proposals/ERC/ERC consolidator grant/Data_GRASS/GRASS_map_simple.png",
       dpi=1000)
